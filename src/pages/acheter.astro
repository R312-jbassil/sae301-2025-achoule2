---
import Layout from '../layouts/Layout.astro'
import Header from '../components/Header.astro'
import Footer from '../components/Footer.astro'
---
<Layout>
  <Header/>
  <main class="max-w-xl mx-auto px-4 pt-10">
    <h1 class="text-2xl font-bold mb-6">Commande en ligne</h1>
    <div id="recap" class="mb-6"></div>
    <form id="commandeForm" class="bg-white p-5 rounded shadow border" style="max-width:480px">
      <label class="block mb-2">Nom&nbsp;: <input name="nom" required class="border px-2 py-1 rounded w-full" /></label>
      <label class="block mb-2">Email&nbsp;: <input name="email" type="email" required class="border px-2 py-1 rounded w-full"/></label>
      <label class="block mb-2">Adresse&nbsp;: <input name="adresse" required class="border px-2 py-1 rounded w-full"/></label>
      <button type="submit" class="bg-red-600 text-white font-bold rounded py-2 px-6 mt-4">Valider la commande</button>
    </form>
    <div id="confirmation" class="mt-6 text-green-700 font-bold"></div>
  </main>
  <script>
    const params = new URLSearchParams(window.location.search);
    const idx = params.get('idx');
    const creations = JSON.parse(localStorage.getItem('creations') || '[]');
    const produit = creations[idx];
    if (produit) {
      document.getElementById('recap').innerHTML = `
        <div class='p-4 border mb-2 rounded bg-black text-white'>
          <div class='mb-2'><b>Monture :</b> ${produit.frameMaterial}</div>
          <div class='mb-2'><b>Branches :</b> ${produit.templeMaterial}</div>
          <div class='mb-2'><b>Dimensions :</b> ${produit.bridgeWidth || ''}mm / ${produit.lensSize || ''}mm</div>
          <div>${produit.svg}</div>
        </div>
      `;
    } else {
      document.getElementById('recap').innerText = 'Produit inconnu.';
    }
    document.getElementById('commandeForm').onsubmit = (e) => {
      e.preventDefault();
      document.getElementById('confirmation').innerText =
        'Merci pour votre commande ! Ce tunnel de paiement est simul√©.';
    };
  </script>
  <Footer/>
</Layout>


